class Undyne extends GraphicsObject{static#hairDefaultPos=new PIXI.Point(310,40);static#headDefaultPos=new PIXI.Point(318,51);static#bodyDefaultPos=new PIXI.Point(324,111);static#rightArmDefaultPos=new PIXI.Point(308,98);static#leftArmDefaultPos=new PIXI.Point(369,134);static#skirtDefaultPos=new PIXI.Point(320,164);static#legsDefaultPos=new PIXI.Point(324,210);#difficulty;#animationTime;#animationState;#swingArmOriginalHeartColor;#player;#hairSprite;#headSprite;#bodySprite;#rightArmSprite;#leftArmSprite;#skirtSprite;#legsSprite;#speechBubble;#greenRectangleManager;#opacityGraphics;constructor(t){super(),this.#difficulty=t,this.#animationTime=0,this.#animationState="breathing";const e=[];for(let t=0;t<4;++t)e.push(Main.runner.assetManager.getTexture("undyneHair"+t));this.#hairSprite=new PIXI.extras.MovieClip(e),this.#hairSprite.anchor.set(1,.5),this.#hairSprite.scale.set(2,2),this.#hairSprite.position.set(Undyne.#hairDefaultPos.x,Undyne.#hairDefaultPos.y),this.#hairSprite.animationSpeed=4/30,this.#headSprite=new PIXI.Sprite(Main.runner.assetManager.getTexture("undyneHead")),this.#headSprite.anchor.set(.5,.5),this.#headSprite.scale.set(2,2),this.#headSprite.position.set(Undyne.#headDefaultPos.x,Undyne.#headDefaultPos.y),this.#bodySprite=new PIXI.Sprite(Main.runner.assetManager.getTexture("undyneBreastplate")),this.#bodySprite.anchor.set(.5,.5),this.#bodySprite.scale.set(2,2),this.#bodySprite.position.set(Undyne.#bodyDefaultPos.x,Undyne.#bodyDefaultPos.y),this.#rightArmSprite=new PIXI.Sprite(Main.runner.assetManager.getTexture("undyneRightArm")),this.#rightArmSprite.anchor.set(1,0),this.#rightArmSprite.scale.set(2,2),this.#rightArmSprite.position.set(Undyne.#rightArmDefaultPos.x,Undyne.#rightArmDefaultPos.y),this.#leftArmSprite=new PIXI.Sprite(Main.runner.assetManager.getTexture("undyneLeftArm")),this.#leftArmSprite.anchor.set(.5,.5),this.#leftArmSprite.scale.set(2,2),this.#leftArmSprite.position.set(Undyne.#leftArmDefaultPos.x,Undyne.#leftArmDefaultPos.y),this.#skirtSprite=new PIXI.Sprite(Main.runner.assetManager.getTexture("undyneSkirt")),this.#skirtSprite.anchor.set(.5,.5),this.#skirtSprite.scale.set(2,2),this.#skirtSprite.position.set(Undyne.#skirtDefaultPos.x,Undyne.#skirtDefaultPos.y),this.#legsSprite=new PIXI.Sprite(Main.runner.assetManager.getTexture("undyneLegs")),this.#legsSprite.anchor.set(.5,.5),this.#legsSprite.scale.set(2,2),this.#legsSprite.position.set(Undyne.#legsDefaultPos.x,Undyne.#legsDefaultPos.y),this.#greenRectangleManager=new GreenRectangleManager,this.#speechBubble=new SpeechBubble,this.#opacityGraphics=new PIXI.Graphics,this.opacity=1,this.#opacityGraphics.beginFill(0,1),this.#opacityGraphics.drawRect(0,0,640,480),this.#opacityGraphics.endFill(),Main.runner.gameplayStage.addChild(this.#hairSprite),Main.runner.gameplayStage.addChild(this.#rightArmSprite),Main.runner.gameplayStage.addChild(this.#leftArmSprite),Main.runner.gameplayStage.addChild(this.#legsSprite),Main.runner.gameplayStage.addChild(this.#skirtSprite),Main.runner.gameplayStage.addChild(this.#bodySprite),Main.runner.gameplayStage.addChild(this.#headSprite),Main.runner.gameplayStage.addChild(this.#opacityGraphics),this.#hairSprite.play()}static getBgm(t){t=t.charAt(0).toUpperCase()+t.slice(1);return Main.runner.assetManager.getAudio("undyne"+t+"Bgm")}set player(t){this.#player=t}get animationState(){return this.#animationState}swingArm(){"swinging arm"!==this.#animationState&&(this.#animationState="swinging arm",this.#swingArmOriginalHeartColor=this.#player.heartColor,this.#bodySprite.position.y=Undyne.#bodyDefaultPos.y,this.#headSprite.position.y=Undyne.#headDefaultPos.y,this.#skirtSprite.position.y=Undyne.#skirtDefaultPos.y,this.#rightArmSprite.position.set(Undyne.#rightArmDefaultPos.x,Undyne.#rightArmDefaultPos.y),this.#leftArmSprite.position.set(Undyne.#leftArmDefaultPos.x,Undyne.#leftArmDefaultPos.y),this.#animationTime=0,Main.runner.gameplayStage.removeChild(this.#rightArmSprite),Main.runner.gameplayStage.addChild(this.#rightArmSprite))}reset(){this.opacity=1,this.#greenRectangleManager.reset(),this.#speechBubble.reset()}breathingAnimation(){1200<this.#animationTime&&(this.#animationTime-=1200);var t=this.#animationTime/1200*Math.PI*2;this.#bodySprite.position.y=Undyne.#bodyDefaultPos.y+2*Math.sin(t),this.#headSprite.position.y=Undyne.#headDefaultPos.y+Math.sin(t),this.#skirtSprite.position.y=Undyne.#skirtDefaultPos.y+Math.sin(t),this.#rightArmSprite.position.x=Undyne.#rightArmDefaultPos.x+2*Math.sin(t),this.#rightArmSprite.position.y=Undyne.#rightArmDefaultPos.y+4*Math.sin(t),this.#leftArmSprite.position.x=Undyne.#leftArmDefaultPos.x+2*Math.sin(2*t),this.#leftArmSprite.position.y=Undyne.#leftArmDefaultPos.y+4*Math.sin(t)}swingingArmAnimation(){let t,e,i,a;var n;this.#animationTime<300?(t=0,e=40,i=0,a=200):this.#animationTime<600?(t=40,e=-60,i=300,a=400):this.#animationTime<750&&(t=-60,e=0,i=600,a=650),this.#animationTime<600?(n=MathUtility.clampInterpolate(this.#animationTime,i,a,0,1),n=Math.pow(n,4),this.#rightArmSprite.rotation=Math.PI/180*MathUtility.interpolate(n,t,e)):this.#animationTime<750?this.#rightArmSprite.rotation=Math.PI/180*MathUtility.clampInterpolate(this.#animationTime,i,a,t,e):(Main.runner.gameplayStage.removeChild(this.#rightArmSprite),Main.runner.gameplayStage.addChildAt(this.#rightArmSprite,0),this.#animationState="breathing",this.#animationTime=0),394<=this.#animationTime&&this.#player.heartColor===this.#swingArmOriginalHeartColor&&("green"===this.#swingArmOriginalHeartColor?(this.#player.heartColor="red",this.#player.hideShieldSprites()):(this.#player.heartColor="green",Undyne.getBgm(this.#difficulty).play(),this.#player.showShieldSprites()))}update(t){this.#greenRectangleManager.update(t),this.#speechBubble.update(t),this.#animationTime+=t,"breathing"===this.#animationState?this.breathingAnimation():"swinging arm"===this.#animationState&&this.swingingArmAnimation()}render(){this.#greenRectangleManager.render()}get greenRectangleManager(){return this.#greenRectangleManager}get speechBubble(){return this.#speechBubble}set opacity(t){this.#opacityGraphics.alpha=1-t}}
